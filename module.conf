# MalwareProtector KPM 模块配置文件
# 用于定义模块的基本信息和配置参数

[module]
# 模块基本信息
name = malware_protector
version = 1.0.0
description = Android恶意脚本防护KPM模块
author = Security Team
license = GPL-2.0
homepage = https://github.com/your-repo/malware-protector-kpm

# 模块类型和架构
type = kpm
arch = arm64,arm
kernel_version = 4.14+

# 依赖信息
[dependencies]
kernelpatch = 0.10.0+
apatch = 10000+
kernelsu = 0.6.0+

# 模块配置
[config]
# 默认启用状态
enabled = true

# 用户确认超时时间 (秒)
timeout = 5

# 调试模式
debug = false

# 日志级别 (0=关闭, 1=错误, 2=警告, 3=信息, 4=调试)
log_level = 2

# 最大日志条目数
max_log_entries = 1000

# 保护的敏感分区列表
[sensitive_partitions]
partitions = [
    "persist",
    "vm-persist", 
    "modem_a",
    "modem_b",
    "modemst1",
    "modemst2",
    "fsg",
    "fsc",
    "abl_a",
    "abl_b",
    "featenabler_a",
    "featenabler_b",
    "xbl_a",
    "xbl_b",
    "xbl_config_a",
    "xbl_config_b",
    "xbl_ramdump_a",
    "xbl_ramdump_b",
    "xbl_sc_logs",
    "xbl_sc_test_mode",
    "vendor_boot_a",
    "vendor_boot_b",
    "ocdt"
]

# 危险命令列表
[dangerous_commands]
commands = [
    "dd",
    "cat",
    "cp",
    "mv",
    "rm",
    "chmod",
    "chown",
    "mount",
    "umount",
    "mknod",
    "blockdev"
]

# 危险参数模式
patterns = [
    "if=/dev/zero",
    "of=/dev/block",
    "of=/dev/mmcblk",
    "of=/dev/sd",
    "/dev/input/*",
    "/proc/partitions"
]

# 系统调用拦截配置
[syscall_hooks]
# 要拦截的系统调用
syscalls = [
    "execve",
    "execveat",
    "openat",
    "open",
    "write",
    "writev"
]

# Hook优先级
priority = 100

# 性能配置
[performance]
# 最大并发处理数
max_concurrent = 100

# 缓存大小
cache_size = 1024

# 统计信息更新间隔 (毫秒)
stats_interval = 1000

# 用户界面配置
[ui]
# 确认对话框标题
dialog_title = "安全警告"

# 确认对话框消息模板
dialog_message = "检测到危险操作：%s\n\n目标：%s\n\n是否允许执行？\n\n音量+ = 允许\n音量- = 拒绝\n%d秒后自动拒绝"

# 按键映射
key_confirm = "KEY_VOLUMEUP"
key_deny = "KEY_VOLUMEDOWN"

# 安全策略
[security]
# 自动拒绝敏感分区操作
auto_deny_sensitive = true

# 白名单进程 (不拦截)
whitelist_processes = [
    "system_server",
    "init",
    "kernel"
]

# 黑名单进程 (总是拦截)
blacklist_processes = [
    "malware",
    "trojan"
]

# 最大拦截次数 (防止DoS)
max_intercepts_per_second = 10

# 日志配置
[logging]
# 日志文件路径
log_file = "/proc/malware_protector/log"

# 日志格式
log_format = "[%timestamp%] [%level%] %message%"

# 日志轮转大小 (KB)
log_rotate_size = 1024

# 保留日志文件数
log_keep_files = 5

# 网络配置 (如果需要远程日志)
[network]
# 启用远程日志
remote_logging = false

# 远程日志服务器
remote_server = "192.168.1.100"
remote_port = 514

# 更新配置
[update]
# 检查更新间隔 (小时)
check_interval = 24

# 更新服务器URL
update_url = "https://api.github.com/repos/your-repo/malware-protector-kmp/releases/latest"

# 自动更新
auto_update = false

# 开发配置
[development]
# 开发模式
dev_mode = false

# 测试模式
test_mode = false

# 调试输出到dmesg
dmesg_debug = true

# 性能分析
profiling = false

# 兼容性配置
[compatibility]
# 支持的内核版本范围
min_kernel_version = "4.14.0"
max_kernel_version = "6.0.0"

# 支持的Android版本
min_android_version = 8
max_android_version = 14

# 设备特定配置
[device_specific]
# 高通设备特殊处理
qualcomm_devices = true

# 联发科设备特殊处理
mediatek_devices = true

# 三星设备特殊处理
samsung_devices = true

# 华为设备特殊处理
huawei_devices = true